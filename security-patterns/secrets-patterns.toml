# Secrets detection patterns (regex + high-entropy hints)
# Used by runner to scan all file content; update from GitHub Advisory DB

[meta]
version = "1.0"
description = "Secrets and credentials patterns"

[[patterns]]
id = "aws_access_key"
name = "AWS Access Key ID"
priority = "P0"
regex = '''AWS_ACCESS_KEY_ID\s*=\s*['"]?[A-Za-z0-9/+=]{20,}['"]?'''
scope = "all"

[[patterns]]
id = "aws_secret"
name = "AWS Secret Access Key"
priority = "P0"
regex = '''AWS_SECRET_ACCESS_KEY\s*=\s*['"]?[A-Za-z0-9/+=]{40}['"]?'''
scope = "all"

[[patterns]]
id = "private_key"
name = "Private key (RSA/EC/DSA)"
priority = "P0"
regex = '''-----BEGIN (RSA |EC |DSA )?PRIVATE KEY-----'''
multiline = true
scope = "all"

[[patterns]]
id = "github_token"
name = "GitHub token"
priority = "P0"
regex = '''(ghp_|gho_|ghu_)[A-Za-z0-9]{36}'''
scope = "all"

[[patterns]]
id = "generic_high_entropy"
name = "High-entropy secret-like string"
priority = "P2"
regex = '''(password|passwd|secret|token|api_key)\s*[:=]\s*['"][^'"]{24,}['"]'''
scope = "all"
